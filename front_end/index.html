<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>CS.314 Chat App</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="scripts.js" defer></script>
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <script src="https://accounts.google.com/gsi/client" async></script>
  </head>
  <body>

    <div id="g_id_onload"
     data-client_id="278406872967-ds0j19p8s6gouvvklrma8cmpjicpmnfu.apps.googleusercontent.com"
     data-context="signin"
     data-ux_mode="popup"
     data-auto_prompt="false"
     data-callback="handleCredentialResponse"
     data-skip_prompt_cookie="">
    </div>
    <!-- Can use use_fedcm_for_prompt="true" to not use 3rd party cookies, but only works on chrome-->

    <div class="g_id_signin"
        data-type="standard"
        data-shape="rectangular"
        data-theme="outline"
        data-text="signin_with"
        data-size="large"
        data-auto_select="true"
        data-logo_alignment="left">
    </div>

    <form id="message-text" class="send-message-form">
        <!-- Message Box -->
        <input type="text" name="message" id="message" placeholder="Message">
        <!-- Submit Button -->
        <input type="submit" value="Send" />
    </form>

  <form id="username-text" class="send-message-form">
      <!-- Message Box -->
      <input type="text" name="username" id="username" placeholder="Username">
      <!-- Submit Button -->
      <input type="submit" value="Send" />
  </form>

  <form id="chat-text" class="send-message-form">
    <!-- Message Box -->
    <input type="text" name="chat" id="chat" placeholder="Chat">
    <!-- Submit Button -->
    <input type="submit" value="Send" />
</form>

    <ul id="messages"></ul>
    
    <script>
      window.onload = function() 
      {
        socket_connection();
        read_cookie("id_token");
      }
    </script>

    <script>  
    function handleCredentialResponse (response) {
      // decodeJwtResponse() is a custom function defined by you
      // to decode the credential response.
      const responsePayload = decodeJwtResponse(response.credential)
      const email = responsePayload['email']; 
      console.log(email, "just tried to signed in.");
      globalsocket.emit('google_sign', response);
      
      //try to save token
      save_cookie(response);
    }
    </script>

  </body>
</html> 